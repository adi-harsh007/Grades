{% extends "base.html" %}
{% block title %}Documents - SecureVault{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h3 class="fw-bold mb-1"><i class="bi bi-folder2-open me-2"></i>My Documents</h3>
        <p class="text-muted mb-0">Manage and share your files</p>
    </div>
    <a href="{{ url_for('documents.upload') }}" class="btn btn-primary">
        <i class="bi bi-cloud-arrow-up me-1"></i>Upload
    </a>
</div>

<!-- Own Documents -->
{% if own_docs %}
<h5 class="fw-bold mb-3"><i class="bi bi-file-earmark-lock me-2"></i>Your Files</h5>
{% for doc in own_docs %}
<div class="glass-card doc-card">
    <div class="doc-icon"><i class="bi bi-file-earmark-text"></i></div>
    <div class="doc-info">
        <h6 class="mb-0">{{ doc.original_name }}</h6>
        <small>Uploaded {{ doc.upload_date.strftime('%b %d, %Y') }} &bull; {{ (doc.file_size / 1024) | round(1) }} KB
            {% if doc.is_public %}<span class="badge bg-info ms-1">Public</span>{% endif %}
        </small>
        {% if doc.description %}<p class="text-muted small mb-0 mt-1">{{ doc.description }}</p>{% endif %}
    </div>
    <div class="d-flex gap-2">
        <a href="{{ url_for('documents.download', doc_id=doc.id) }}" class="btn btn-sm btn-outline-primary"
            title="Download"><i class="bi bi-download"></i></a>
        <a href="{{ url_for('documents.share', doc_id=doc.id) }}" class="btn btn-sm btn-outline-primary"
            title="Share"><i class="bi bi-share"></i></a>
        <form method="POST" action="{{ url_for('documents.delete', doc_id=doc.id) }}" style="display:inline;"
            onsubmit="return confirm('Delete this document?');">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="btn btn-sm btn-outline-danger" title="Delete"><i
                    class="bi bi-trash"></i></button>
        </form>
    </div>
</div>
{% endfor %}
{% else %}
<div class="glass-card p-4 text-center mb-4">
    <i class="bi bi-cloud-upload display-4 text-muted"></i>
    <p class="text-muted mt-2 mb-0">You haven't uploaded any documents yet.</p>
</div>
{% endif %}

<!-- Shared With Me -->
{% if shared_docs %}
<h5 class="fw-bold mb-3 mt-4"><i class="bi bi-people me-2"></i>Shared With Me</h5>
{% for doc in shared_docs %}
<div class="glass-card doc-card">
    <div class="doc-icon"><i class="bi bi-file-earmark-person"></i></div>
    <div class="doc-info">
        <h6 class="mb-0">{{ doc.original_name }}</h6>
        <small>By {{ doc.owner.username }} &bull; {{ (doc.file_size / 1024) | round(1) }} KB</small>
    </div>
    <a href="{{ url_for('documents.download', doc_id=doc.id) }}" class="btn btn-sm btn-outline-primary"><i
            class="bi bi-download"></i></a>
</div>
{% endfor %}
{% endif %}

<!-- Public Documents -->
{% if public_docs %}
<h5 class="fw-bold mb-3 mt-4"><i class="bi bi-globe me-2"></i>Public Documents</h5>
{% for doc in public_docs %}
<div class="glass-card doc-card">
    <div class="doc-icon"><i class="bi bi-file-earmark-richtext"></i></div>
    <div class="doc-info">
        <h6 class="mb-0">{{ doc.original_name }}</h6>
        <small>By {{ doc.owner.username }} &bull; {{ (doc.file_size / 1024) | round(1) }} KB</small>
    </div>
    <a href="{{ url_for('documents.download', doc_id=doc.id) }}" class="btn btn-sm btn-outline-primary"><i
            class="bi bi-download"></i></a>
</div>
{% endfor %}
{% endif %}
{% endblock %}